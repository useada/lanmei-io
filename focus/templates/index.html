{% include "header.html" %}
{% load myfilter %}
{% load staticfiles %}

<div class="container-fluid">
    <div class="col-sm-1"></div>

    <!-- Center Column -->
    <div class="col-sm-8">

    <div class="row">
        <div class="col-sm-12">
{#            {% load staticfiles %}#}
{#            <img src="{% static "img/lanmei-show.jpg" %}" alt="..." class="img-responsive">#}
{#            <h3 style="color: #104c80;">每期有一个主题, 围绕主题写故事</h3>#}
{#            <br>#}
{#            <p>#}
{#                <span class="h3">本期主题:</span> <a>她去洗澡了</a>#}
{#            </p>#}
{#            <hr>#}

            <div style="background-color:#f2f8ff; !important" class="jumbotron">
                <h1 style="color: darkblue;">开心咖啡&nbsp;<small style="color: #104c80;">(来点儿有意思的)</small></h1>

{#                <h3 style="color: #104c80;">每期有一个主题, 围绕主题写故事</h3>#}

                {% if status %}
                <p>
                    <span class="h3">本期主题:</span> <a href="/focus/{{ status.curr_topic.id }}/">{{ status.curr_topic.content }}</a>
                    <br>
                    <a href="/focus/topic_list/"><span class="text-muted h5">查看其它主题</span></a>
                </p>
                {% endif %}
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-sm-12" id="article_list">
        <!-- Articles -->
        {% for article in top10_article_list %}
            <div class="row">
                <div class="col-xs-12">

                    <div class="media">
                        <a class="media-left" href="/focus/people/{{ article.author.salt }}">
                            {% if article.author.avatar %}
                                <img src="{{ article.author.avatar }}" alt="..." width="64" height="64" />
                            {% else %}
                                <img src="{% static "img/default_avatar.jpg" %}" alt="..." width="64" height="64" />
                            {% endif %}
                        </a>
                        <div class="media-body">
{#                            <h4 class="media-heading">Media heading</h4>#}
                            <p>
                                <a href="/focus/people/{{ article.author.salt }}"><b class="text-info">{{ article.author }}</b></a>

                                {% if article.author.profile %}
                                    . <span class="text-muted small">{{ article.author.profile }}</span>
                                {% endif %}
                                <span class="text-muted small">{{ article.pub_date|my_date }}</span>
                            </p>

                            <h4>
                                <a href="/focus/{{ article.topic_id }}">
                                    {{ article.topic.content|truncatechars_html:80 | safe }}
                                </a>
                            </h4>

                            {{ article.content|truncatechars_html:80 | safe }}
                            <a class="text-muted" href="/focus/{{ article.topic_id }}/#article-{{ article.id }}-box">点击阅读</a>

                            <ul class="list-inline small">
                                <li><span class="text-muted"><span class="glyphicon glyphicon-comment"></span> {{ article.comment_num }} 评论</span></li>
                                <li><span class="text-muted"><span class="glyphicon glyphicon-star"></span>{{ article.poll_num }} 赞</span></li>
                            </ul>


                        </div>
                    </div>
                </div>
            </div>
            <hr>
        {% endfor %}
{#            <div id="end_of_article_list"></div>#}
        </div>
    </div>

        <div class="row">
            <div class="col-sm-12">
                <a id="index_more" article_index="10" class="btn btn-info btn-lg btn-block" href="javascript:void(0);">更多</a>
            </div>
        </div>

    </div><!--/Center Column-->

<script type="text/javascript">
$("#index_more").click(function() {
        var $this = $(this);
        $this.text('加载中...');
        var url = '/focus/index_more';
        var article_index = $this.attr("article_index");
        if (article_index) {
            $.get(url, {article_index: article_index}, function(data){
                $('#article_list').append(data.content);
                $this.attr("article_index", data.article_index);
                $this.text('更多');
            });
        }

        return false;
    });
</script>

    <!-- Right Column -->
<div class="col-sm-3">
{% include "righter.html" %}
</div>

</div><!--/container-fluid-->

{% include "footer.html" %}